<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RSVP – Boda</title>
  <style>
    @font-face{
      font-family:'NightWindSent';
      src: url('NightWindSentSample.ttf') format('truetype'),
           url('NightWindSentSample.otf') format('opentype');
      font-weight:400; font-style:normal; font-display:swap;
    }

    :root{
      --bg:#f3f2ee;           /* fondo crema */
      --ink:#a81b21;          /* rojo principal */
      --padX:9%;              /* padding lateral dentro del marco */
      --padY:13%;             /* padding sup/inf dentro del marco */
      --bgShiftX:0px;         /* afina centrado del SVG (+/- px) */
      --maxW:760px;           /* ancho máximo del marco */
      --ratio:768/1075;       /* AJUSTA al viewBox real del SVG */
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;overflow-x:hidden}
    body{
      background:var(--bg);
      font-family:'Playfair Display',serif;
      color:var(--ink);
      display:grid;place-items:center;
      padding:16px;
    }

    .frame{
      width:min(92vw,var(--maxW));
      aspect-ratio:var(--ratio);
      background:var(--bg) url('/assets/framev4.svg') no-repeat
                  calc(50% + var(--bgShiftX)) center/contain;
      position:relative;display:flex;align-items:center;justify-content:center;
    }

    .content{position:absolute;inset:var(--padY) var(--padX);
      display:grid;gap:14px;place-items:center;text-align:center}

    h1{
      font-family:'NightWindSent',cursive;
      font-size:clamp(28px,5.8vw,56px);
      letter-spacing:.3px
    }

    form{display:grid;gap:12px;width:min(520px,100%)}
    label{font-weight:600}
    select{
      width:100%;font:inherit;padding:10px 12px;border:1px solid #a81b2133;
      border-radius:10px;background:#fff
    }

    .choices{display:flex;gap:10px;width:100%}
    .choices button{
      flex:1 1 0;padding:12px 14px;font:inherit;border-radius:999px;
      border:1px solid var(--ink);background:#fff;color:var(--ink);cursor:pointer
    }
    .choices button[aria-pressed="true"]{background:var(--ink);color:#fff}

    .submit{
      padding:12px 16px;border:none;border-radius:999px;background:var(--ink);
      color:#fff;font-weight:700;cursor:pointer;width:100%
    }

    .error{font-size:.9rem;color:#8e151a;min-height:1.2em}

    @media (max-width:420px){
      :root{--padX:11%;--padY:15%}
      h1{font-size:clamp(26px,7vw,42px)}
    }

    @media (prefers-reduced-motion:reduce){
      *,*:before,*:after{animation:none!important;transition:none!important}
    }
  </style>
</head>
<body>
  <div class="frame">
    <div class="content">
      <h1>Confirma asistencia</h1>

      <form id="rsvp" action="https://script.google.com/macros/s/AKfycbzTE4WPKTexIvxcSF8w8E4sY2lJUXkajDCHQ2DvKYQVHlc7zanfsRIgm2DN5n7Le4Jm/exec" method="POST">
        <!-- Ajusta la URL del Google Apps Script aquí -->
        <input type="hidden" name="_subject" value="RSVP Boda – Nueva respuesta">
        <input type="hidden" name="_redirect" value="/gracias.html">
        <input type="text" name="_gotcha" tabindex="-1" autocomplete="off" style="position:absolute;left:-9999px" aria-hidden="true">

        <div style="width:100%">
          <label for="nombre">Nombre</label>
          <select id="nombre" name="nombre" required>
            <option value="" disabled selected>Selecciona tu nombre…</option>
            <option>Ana Pérez</option>
            <option>Juan García</option>
            <option>Carolina Soto</option>
            <option>Martín Rivas</option>
            <option>Valentina Herrera</option>
            <option>Felipe González</option>
            <option>María José</option>
            <option>Diego Torres</option>
            <option>Catalina López</option>
            <option>Benjamín Silva</option>
            <option>Sofía Vargas</option>
            <option>Camila Díaz</option>
          </select>
        </div>

        <input type="hidden" name="asistencia" id="asistencia" required>
        <div class="choices" role="group" aria-label="Asistencia">
          <button type="button" data-value="Sí" aria-pressed="false">Confirmar asistencia</button>
          <button type="button" data-value="No" aria-pressed="false">No podré asistir</button>
        </div>

        <div id="msg" class="error" aria-live="polite"></div>

        <button class="submit" type="submit">Enviar</button>
      </form>
    </div>
  </div>

  <script>
    const hidden = document.getElementById('asistencia');
    const btns = document.querySelectorAll('.choices button');
    const form = document.getElementById('rsvp');
    const msg = document.getElementById('msg');

    btns.forEach(b=>{
      b.addEventListener('click',()=>{
        btns.forEach(x=>x.setAttribute('aria-pressed','false'));
        b.setAttribute('aria-pressed','true');
        hidden.value = b.dataset.value;
        msg.textContent = '';
      });
    });

    // Validación mínima antes de enviar
    form.addEventListener('submit', (e)=>{
      if(!hidden.value){
        e.preventDefault();
        msg.textContent = 'Por favor elige “Confirmar asistencia” o “No podré asistir”.';
        return;
      }
      // Guarda la respuesta en sessionStorage para usar en gracias.html
      sessionStorage.setItem('asistencia', hidden.value);
    });

    // Prefill via URL (?name=...&assist=si/no)
    (function(){
      const p=new URLSearchParams(location.search);
      const n=p.get('name');
      if(n){
        const sel=document.getElementById('nombre');
        const opt=[...sel.options].find(o=>o.text.toLowerCase()===n.toLowerCase());
        if(opt) sel.value=opt.text;
      }
      const a=p.get('assist');
      if(a){
        const match=[...btns].find(x=>x.dataset.value.toLowerCase().startsWith(a.toLowerCase()));
        if(match){match.click();}
      }
    })();
  </script>
</body>
</html>
